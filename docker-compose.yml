services:
  surf-data-service:
    build: ./services/surf-data-service
    expose:
      - "5001"
    environment:
      - ENVIRONMENT=${ENVIRONMENT:-DEV}

  notification-service:
    build: ./services/notification-service
    expose:
      - "5002"
    environment:
      - ENVIRONMENT=${ENVIRONMENT:-DEV}

  jaeger:
    image: jaegertracing/all-in-one:1.57
    expose:
      - "4318"

  gateway:
    build: ./services/gateway
    ports:
      - "5000:5000"
    environment:
      - ENVIRONMENT=${ENVIRONMENT:-DEV}
      - ENABLE_OTEL=false
      - INTERNAL_TOKEN=${INTERNAL_TOKEN:-dev-token}
      - SURF_DATA_URL=http://surf-data-service:5001
      - NOTIFY_URL=http://notification-service:5002
    depends_on:
      - surf-data-service
      - notification-service
      - jaeger

  scheduler-service:
    build: ./services/scheduler-service
    environment:
      - ENVIRONMENT=${ENVIRONMENT:-DEV}
      - INTERNAL_TOKEN=${INTERNAL_TOKEN:-dev-token}
      - GATEWAY_URL=http://gateway:5000
      - SCHEDULE_SECONDS=${SCHEDULE_SECONDS:-60}
    depends_on:
      - gateway
